<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EMHS Interactive Course Planner</title>
  <link rel="stylesheet" href="../../shared/css/styles.css">
  <link rel="stylesheet" href="planner-styles.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container planner-container">
    <header>
      <h1>üìã Interactive Course Planner</h1>
      <p>Plan your high school journey from Grade 10 to 12. Click on an empty slot to add a course and track your graduation progress.</p>
    </header>

    <main>
      <section id="graduation-tracker" class="card">
        <h2>Graduation Progress</h2>
        <div class="progress-bar-container">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
        <p>Total Credits: <span id="credit-count">0</span> / 100</p>
        <div id="requirements-checklist">

        </div>
        <div id="target-program-module" class="target-program-module">
          <div class="program-selectors">
            <div>
              <label for="university-select">Target University:</label>
              <select id="university-select">
                <option value="">-- Select a University --</option>
              </select>
            </div>
            <div>
              <label for="program-select">Target Program:</label>
              <select id="program-select" disabled>
                <option value="">-- Select a University First --</option>
              </select>
            </div>
          </div>
          <div id="preset-actions" style="display: none; align-items: flex-end; gap: 0.5rem;">
             <button id="load-preset-btn" title="Auto-fill the best course route for this program">Load Best Route Preset</button>
             <button id="preset-settings-btn" title="Preset Settings" style="padding: 0.75rem;">‚öôÔ∏è</button>
          </div>
        </div>
        <div class="planner-controls">
          <button id="save-plan">Save Plan</button>
          <button id="load-plan">Load Plan</button>
          <button id="export-pdf">Export as PDF</button>
          <button id="reset-plan" class="danger-btn">Reset Plan</button>
        </div>
      </section>

      <div id="planner-grid">
        <div class="grade-column">
          <h2>Grade 10</h2>
          <div id="grade-10-courses" class="course-list"></div>
          <div class="grade-footer">
            <strong>Credits: <span id="grade-10-credits">0</span></strong>
          </div>
        </div>

        <div class="summer-column">
            <h2>Summer</h2>
            <div id="summer-after-grade-10" class="course-list"></div>
        </div>

        <div class="grade-column">
          <h2>Grade 11</h2>
          <div id="grade-11-courses" class="course-list"></div>
          <div class="grade-footer">
            <strong>Credits: <span id="grade-11-credits">0</span></strong>
          </div>
        </div>

        <div class="summer-column">
            <h2>Summer</h2>
            <div id="summer-after-grade-11" class="course-list"></div>
        </div>

        <div class="grade-column">
          <h2>Grade 12</h2>
          <div id="grade-12-courses" class="course-list"></div>
          <div class="grade-footer">
            <strong>Credits: <span id="grade-12-credits">0</span></strong>
          </div>
        </div>
      </div>
    </main>
  </div>


  <div id="course-selection-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <h3>Add a Course</h3>
      <input type="text" id="course-search-input" placeholder="Search by name or subject (e.g., 'Math', 'Art')">
      <div id="modal-course-list">

      </div>
      <button id="modal-cancel-selection" class="danger-btn">Cancel</button>
    </div>
  </div>

  <div id="details-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <h3 id="details-modal-course-name">Course Details</h3>
      <p>Credits: <span id="details-modal-credits"></span></p>
      <p>Status: <span id="details-modal-status"></span></p>
      <button id="details-modal-visualize">Visualize Prerequisites</button>
      <button id="details-modal-switch-delivery">Switch to Online</button>
      <button id="details-modal-remove" class="danger-btn">Remove from Plan</button>
      <button id="details-modal-close">Close</button>
    </div>
  </div>

  <!-- New Modals for Save/Load/Reset -->
  <div id="confirm-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <h3 id="confirm-modal-title">Confirm Action</h3>
      <p id="confirm-modal-message">Are you sure?</p>
      <button id="confirm-modal-button">Confirm</button>
      <button id="confirm-modal-cancel" class="danger-btn">Cancel</button>
    </div>
  </div>

  <div id="info-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <h3 id="info-modal-title">Notification</h3>
      <div id="info-modal-message">Here is some information.</div>
      <button id="info-modal-close">Close</button>
    </div>
  </div>

  <!-- New Prerequisite Visualizer Modal -->
  <div id="prereq-visualizer-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content">
          <h3 id="prereq-modal-title">Prerequisite Path</h3>
          <div id="prereq-tree-container">
              <!-- Tree will be generated here -->
          </div>
          <div class="prereq-legend">
              <span class="legend-item met">Planned</span>
              <span class="legend-item missing">Missing</span>
              <span class="legend-item target">Target</span>
          </div>
          <button id="prereq-modal-close" class="danger-btn">Close</button>
      </div>
  </div>

  <!-- New Preset Settings Modal -->
  <div id="preset-settings-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <h3>Preset Customization</h3>
      <p>Customize how the "Best Route" preset is generated.</p>
      
      <div style="text-align: left; margin: 1rem 0;">
        <div style="margin-bottom: 0.75rem;">
          <input type="checkbox" id="setting-allow-summer" checked>
          <label for="setting-allow-summer" style="display: inline;">Allow Summer School</label>
          <p style="font-size: 0.9em; color: #aaa; margin-left: 1.5rem; margin-top: 0;">Use summer sessions to balance workload.</p>
        </div>

        <div>
          <input type="checkbox" id="setting-fill-spares">
          <label for="setting-fill-spares" style="display: inline;">Limit Spares (Fill Schedule)</label>
          <p style="font-size: 0.9em; color: #aaa; margin-left: 1.5rem; margin-top: 0;">Auto-fill empty slots with electives to maximize credits.</p>
        </div>
      </div>

      <button id="preset-settings-save">Save Settings</button>
      <button id="preset-settings-cancel" class="danger-btn">Cancel</button>
    </div>
  </div>

  <div id="tooltip" class="tooltip" style="display: none;"></div>

  <!-- Note the change to type="module" -->
  <script src="planner-logic.js" type="module"></script>
</body>
</html>