<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Grade Calculator</title>
  <link rel="stylesheet" href="../../shared/css/styles.css">
  <style>
    #output {
      max-width: 550px; /* Matches the max-width of #calculator in styles.css */
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h2>General Grade Calculator</h2>
      <p style="text-align:center;">Enter up to 8 course grades (0–100):</p>
    </header>
    <main class="card">
      <div id="inputs">
        <input type="number" id="g1" placeholder="Course 1" min="0" max="100">
        <input type="number" id="g2" placeholder="Course 2" min="0" max="100">
        <input type="number" id="g3" placeholder="Course 3" min="0" max="100">
        <input type="number" id="g4" placeholder="Course 4" min="0" max="100">
        <input type="number" id="g5" placeholder="Course 5" min="0" max="100">
        <input type="number" id="g6" placeholder="Course 6" min="0" max="100">
        <input type="number" id="g7" placeholder="Course 7" min="0" max="100">
        <input type="number" id="g8" placeholder="Course 8" min="0" max="100">
        <button id="calculateButton">Calculate Average</button>
      </div>
      <div id="output"></div>
    </main>
  </div>

  <script type="module">
    function calculateAverage() {
      let sum = 0, count = 0, invalid = false;
      for (let i = 1; i <= 8; i++) {
        const input = document.getElementById('g' + i);
        const grade = parseFloat(input.value);
        if (!isNaN(grade)) {
          if (grade < 0 || grade > 100) {
            invalid = true;
            break;
          }
          sum += grade;
          count++;
        }
      }

      const output = document.getElementById('output');
      output.className = ''; // Reset the class

      if (invalid) {
        output.innerHTML = "❌ Please enter grades only between 0 and 100.";
        output.classList.add('error');
      } else if (count > 0) {
        output.innerHTML = "✅ Overall Average: <strong>" + (sum / count).toFixed(1) + "%</strong>";
        output.classList.add('success');
      } else {
        output.innerHTML = "Enter at least one grade.";
        output.classList.add('error');
      }
    }

    // Attach event listener to the button
    document.getElementById('calculateButton').addEventListener('click', calculateAverage);
    
    // Attach real-time validation listeners
    for (let i = 1; i <= 8; i++) {
      const input = document.getElementById('g' + i);
      if (input) {
        input.addEventListener('input', () => {
          const grade = parseFloat(input.value);
          if (input.value !== '' && (grade < 0 || grade > 100)) {
            input.classList.add('invalid-input');
          } else {
            input.classList.remove('invalid-input');
          }
        });
      }
    }
  </script>
</body>
</html>